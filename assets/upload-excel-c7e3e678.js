import{P as N,Q as S,o as f,c as m,ai as w,af as E,a3 as b,ab as B,V as y,a4 as C,aV as h,ao as O,J as P,bw as R,bx as F,bh as $,ac as j}from"./index-8a3932f2.js";import{r as A,u as d}from"./xlsx-798df941.js";const J={__name:"index",props:{size:{type:Number,default:5}},emits:["uploadSuccess"],setup(v,{emit:l}){const i=v,s=N({loading:!1,refInput:null}),{loading:_,refInput:o}=S(s),D=e=>{const a=[],t=d.decode_range(e["!ref"]);let n;const p=t.s.r;for(n=t.s.c;n<=t.e.c;++n){const c=e[d.encode_cell({c:n,r:p})];let u="UNKNOWN "+n;c&&c.t&&(u=d.format_cell(c)),a.push(u)}return a},g=e=>{s.loading=!0;const a=new FileReader;a.onload=t=>{const n=t.target.result,p=A(n,{type:"array"}),c=p.SheetNames[0],u=p.Sheets[c],V=D(u),H=d.sheet_to_json(u);l("uploadSuccess",{header:V,results:H}),s.loading=!1},a.readAsArrayBuffer(e)},x=e=>e.size/1024/1024<i.size?!0:(h.warning(`Please do not upload files larger than ${i.size}m in size.`),!1),r=e=>{s.refInput.value=null,x(e)&&g(e)},z=e=>{const t=e.target.files[0];t&&r(t)},I=e=>/\.(xlsx|xls|csv)$/.test(e.name),T=e=>{if(e.stopPropagation(),e.preventDefault(),s.loading)return;const a=e.dataTransfer.files;if(a.length!==1)return h.error("Only support uploading one file!");const t=a[0];if(!I(t))return h.error("Only supports upload .xlsx, .xls, .csv suffix files");r(t)},k=e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},U=()=>{s.refInput.click()};return(e,a)=>{const t=O;return f(),m(C,null,[w("input",{ref_key:"refInput",ref:o,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:z},null,544),w("div",{class:"drop",onDrop:T,onDragover:k,onDragenter:k},[E(" Drop excel file here or "),b(t,{loading:y(_),style:{"margin-left":"16px"},type:"primary",onClick:U},{default:B(()=>[E(" Browse ")]),_:1},8,["loading"])],32)],64)}}};const K={class:"upload-excel-container"},L=P({name:"UploadExcel"}),W=Object.assign(L,{setup(v){const l=N({tableData:[],tableHeader:[]}),{tableData:i,tableHeader:s}=S(l),_=o=>{console.log(o),l.tableData=o.results,l.tableHeader=o.header};return(o,D)=>{const g=R,x=F;return f(),m("div",K,[b(J,{onUploadSuccess:_}),b(x,{data:y(i),border:"","highlight-current-row":"",style:{width:"100%","margin-top":"20px"}},{default:B(()=>[(f(!0),m(C,null,$(y(s),r=>(f(),j(g,{key:r,prop:r,label:r},null,8,["prop","label"]))),128))]),_:1},8,["data"])])}}});export{W as default};
