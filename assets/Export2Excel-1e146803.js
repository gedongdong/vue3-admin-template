import{br as m}from"./index-8a3932f2.js";import{w as _,u as x,S as T}from"./xlsx-798df941.js";var y={},L={get exports(){return y},set exports(u){y=u}};(function(u,h){(function(c,o){o()})(m,function(){function c(e,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function o(e,t,i){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,t,i)},n.onerror=function(){console.error("could not download file")},n.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof m=="object"&&m.global===m?m:void 0,p=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(e,t,i){var n=r.URL||r.webkitURL,f=document.createElement("a");t=t||e.name||"download",f.download=t,f.rel="noopener",typeof e=="string"?(f.href=e,f.origin===location.origin?a(f):s(f.href)?o(e,t,i):a(f,f.target="_blank")):(f.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(f.href)},4e4),setTimeout(function(){a(f)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,i){if(t=t||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(c(e,i),t);else if(s(e))o(e,t,i);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){a(n)})}}:function(e,t,i,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return o(e,t,i);var f=e.type==="application/octet-stream",v=/constructor/i.test(r.HTMLElement)||r.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||f&&v||p)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var w=g.result;w=d?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=w:location=w,n=null},g.readAsDataURL(e)}else{var A=r.URL||r.webkitURL,S=A.createObjectURL(e);n?n.location=S:location.href=S,n=null,setTimeout(function(){A.revokeObjectURL(S)},4e4)}});r.saveAs=l.saveAs=l,u.exports=l})})(L);function k(u){for(var h=[],c=u.querySelectorAll("tr"),o=[],s=0;s<c.length;++s){for(var a=[],r=c[s],p=r.querySelectorAll("td"),l=0;l<p.length;++l){var e=p[l],t=e.getAttribute("colspan"),i=e.getAttribute("rowspan"),n=e.innerText;if(n!==""&&n==+n&&(n=+n),o.forEach(function(v){if(s>=v.s.r&&s<=v.e.r&&a.length>=v.s.c&&a.length<=v.e.c)for(var d=0;d<=v.e.c-v.s.c;++d)a.push(null)}),(i||t)&&(i=i||1,t=t||1,o.push({s:{r:s,c:a.length},e:{r:s+i-1,c:a.length+t-1}})),a.push(n!==""?n:null),t)for(var f=0;f<t-1;++f)a.push(null)}h.push(a)}return[h,o]}function U(u,h){h&&(u+=1462);var c=Date.parse(u);return(c-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function E(u,h){for(var c={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},s=0;s!=u.length;++s)for(var a=0;a!=u[s].length;++a){o.s.r>s&&(o.s.r=s),o.s.c>a&&(o.s.c=a),o.e.r<s&&(o.e.r=s),o.e.c<a&&(o.e.c=a);var r={v:u[s][a]};if(r.v!=null){var p=x.encode_cell({c:a,r:s});typeof r.v=="number"?r.t="n":typeof r.v=="boolean"?r.t="b":r.v instanceof Date?(r.t="n",r.z=T._table[14],r.v=U(r.v)):r.t="s",c[p]=r}}return o.s.c<1e7&&(c["!ref"]=x.encode_range(o)),c}function b(){if(!(this instanceof b))return new b;this.SheetNames=[],this.Sheets={}}function j(u){for(var h=new ArrayBuffer(u.length),c=new Uint8Array(h),o=0;o!=u.length;++o)c[o]=u.charCodeAt(o)&255;return h}function F(u){var h=document.getElementById(u),c=k(h),o=c[1],s=c[0],a="SheetJS",r=new b,p=E(s);p["!merges"]=o,r.SheetNames.push(a),r.Sheets[a]=p;var l=_(r,{bookType:"xlsx",bookSST:!1,type:"binary"});y.saveAs(new Blob([j(l)],{type:"application/octet-stream"}),"test.xlsx")}function M({multiHeader:u=[],header:h,data:c,filename:o,merges:s=[],autoWidth:a=!0,bookType:r="xlsx"}={}){o=o||"excel-list",c=[...c],c.unshift(h);for(let i=u.length-1;i>-1;i--)c.unshift(u[i]);var p="SheetJS",l=new b,e=E(c);if(s.length>0&&(e["!merges"]||(e["!merges"]=[]),s.forEach(i=>{e["!merges"].push(x.decode_range(i))})),a){const i=c.map(f=>f.map(v=>v==null?{wch:10}:v.toString().charCodeAt(0)>255?{wch:v.toString().length*2}:{wch:v.toString().length}));let n=i[0];for(let f=1;f<i.length;f++)for(let v=0;v<i[f].length;v++)n[v].wch<i[f][v].wch&&(n[v].wch=i[f][v].wch);e["!cols"]=n}l.SheetNames.push(p),l.Sheets[p]=e;var t=_(l,{bookType:r,bookSST:!1,type:"binary"});y.saveAs(new Blob([j(t)],{type:"application/octet-stream"}),`${o}.${r}`)}export{M as export_json_to_excel,F as export_table_to_excel};
