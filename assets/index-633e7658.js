import{P as oe,Q as ie,o as ae,c as ue,ai as $,af as M,a3 as H,ab as J,ao as ce}from"./index-8a3932f2.js";var F={},se={get exports(){return F},set exports(U){F=U}};(function(U){(function(L){var a=ee(),v=te(),S=ne(),k=re(),w={imagePlaceholder:void 0,cacheBust:!1},T={toSvg:D,toPng:W,toJpeg:q,toBlob:z,toPixelData:X,impl:{fontFaces:S,images:k,util:a,inliner:v,options:{}}};U.exports=T;function D(n,t){return t=t||{},Q(t),Promise.resolve(n).then(function(i){return O(i,t.filter,!0)}).then(K).then(Y).then(r).then(function(i){return Z(i,t.width||a.width(n),t.height||a.height(n))});function r(i){return t.bgcolor&&(i.style.backgroundColor=t.bgcolor),t.width&&(i.style.width=t.width+"px"),t.height&&(i.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach(function(l){i.style[l]=t.style[l]}),i}}function X(n,t){return N(n,t||{}).then(function(r){return r.getContext("2d").getImageData(0,0,a.width(n),a.height(n)).data})}function W(n,t){return N(n,t||{}).then(function(r){return r.toDataURL()})}function q(n,t){return t=t||{},N(n,t).then(function(r){return r.toDataURL("image/jpeg",t.quality||1)})}function z(n,t){return N(n,t||{}).then(a.canvasToBlob)}function Q(n){typeof n.imagePlaceholder>"u"?T.impl.options.imagePlaceholder=w.imagePlaceholder:T.impl.options.imagePlaceholder=n.imagePlaceholder,typeof n.cacheBust>"u"?T.impl.options.cacheBust=w.cacheBust:T.impl.options.cacheBust=n.cacheBust}function N(n,t){return D(n,t).then(a.makeImage).then(a.delay(100)).then(function(i){var l=r(n);return l.getContext("2d").drawImage(i,0,0),l});function r(i){var l=document.createElement("canvas");if(l.width=t.width||a.width(i),l.height=t.height||a.height(i),t.bgcolor){var s=l.getContext("2d");s.fillStyle=t.bgcolor,s.fillRect(0,0,l.width,l.height)}return l}}function O(n,t,r){if(!r&&t&&!t(n))return Promise.resolve();return Promise.resolve(n).then(i).then(function(o){return l(n,o,t)}).then(function(o){return s(n,o)});function i(o){return o instanceof HTMLCanvasElement?a.makeImage(o.toDataURL()):o.cloneNode(!1)}function l(o,u,p){var x=o.childNodes;if(x.length===0)return Promise.resolve(u);return m(u,a.asArray(x),p).then(function(){return u});function m(I,y,d){var P=Promise.resolve();return y.forEach(function(B){P=P.then(function(){return O(B,d)}).then(function(b){b&&I.appendChild(b)})}),P}}function s(o,u){if(!(u instanceof Element))return u;return Promise.resolve().then(p).then(x).then(m).then(I).then(function(){return u});function p(){y(window.getComputedStyle(o),u.style);function y(d,P){d.cssText?P.cssText=d.cssText:B(d,P);function B(b,A){a.asArray(b).forEach(function(e){A.setProperty(e,b.getPropertyValue(e),b.getPropertyPriority(e))})}}}function x(){[":before",":after"].forEach(function(d){y(d)});function y(d){var P=window.getComputedStyle(o,d),B=P.getPropertyValue("content");if(B===""||B==="none")return;var b=a.uid();u.className=u.className+" "+b;var A=document.createElement("style");A.appendChild(e(b,d,P)),u.appendChild(A);function e(c,h,f){var g="."+c+":"+h,E=f.cssText?V(f):j(f);return document.createTextNode(g+"{"+E+"}");function V(C){var _=C.getPropertyValue("content");return C.cssText+" content: "+_+";"}function j(C){return a.asArray(C).map(_).join("; ")+";";function _(R){return R+": "+C.getPropertyValue(R)+(C.getPropertyPriority(R)?" !important":"")}}}}}function m(){o instanceof HTMLTextAreaElement&&(u.innerHTML=o.value),o instanceof HTMLInputElement&&u.setAttribute("value",o.value)}function I(){u instanceof SVGElement&&(u.setAttribute("xmlns","http://www.w3.org/2000/svg"),u instanceof SVGRectElement&&["width","height"].forEach(function(y){var d=u.getAttribute(y);d&&u.style.setProperty(y,d)}))}}}function K(n){return S.resolveAll().then(function(t){var r=document.createElement("style");return n.appendChild(r),r.appendChild(document.createTextNode(t)),n})}function Y(n){return k.inlineAll(n).then(function(){return n})}function Z(n,t,r){return Promise.resolve(n).then(function(i){return i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(i)}).then(a.escapeXhtml).then(function(i){return'<foreignObject x="0" y="0" width="100%" height="100%">'+i+"</foreignObject>"}).then(function(i){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+i+"</svg>"}).then(function(i){return"data:image/svg+xml;charset=utf-8,"+i})}function ee(){return{escape:I,parseExtension:t,mimeType:r,dataAsUrl:m,isDataUrl:i,canvasToBlob:s,resolveUrl:o,getAndEncode:x,uid:u(),delay:y,asArray:d,escapeXhtml:P,makeImage:p,width:B,height:b};function n(){var e="application/font-woff",c="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:c,jpeg:c,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function t(e){var c=/\.([^\.\/]*?)$/g.exec(e);return c?c[1]:""}function r(e){var c=t(e).toLowerCase();return n()[c]||""}function i(e){return e.search(/^(data:)/)!==-1}function l(e){return new Promise(function(c){for(var h=window.atob(e.toDataURL().split(",")[1]),f=h.length,g=new Uint8Array(f),E=0;E<f;E++)g[E]=h.charCodeAt(E);c(new Blob([g],{type:"image/png"}))})}function s(e){return e.toBlob?new Promise(function(c){e.toBlob(c)}):l(e)}function o(e,c){var h=document.implementation.createHTMLDocument(),f=h.createElement("base");h.head.appendChild(f);var g=h.createElement("a");return h.body.appendChild(g),f.href=c,g.href=e,g.href}function u(){var e=0;return function(){return"u"+c()+e++;function c(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function p(e){return new Promise(function(c,h){var f=new Image;f.onload=function(){c(f)},f.onerror=h,f.src=e})}function x(e){var c=3e4;return T.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime()),new Promise(function(h){var f=new XMLHttpRequest;f.onreadystatechange=V,f.ontimeout=j,f.responseType="blob",f.timeout=c,f.open("GET",e,!0),f.send();var g;if(T.impl.options.imagePlaceholder){var E=T.impl.options.imagePlaceholder.split(/,/);E&&E[1]&&(g=E[1])}function V(){if(f.readyState===4){if(f.status!==200){g?h(g):C("cannot fetch resource: "+e+", status: "+f.status);return}var _=new FileReader;_.onloadend=function(){var R=_.result.split(/,/)[1];h(R)},_.readAsDataURL(f.response)}}function j(){g?h(g):C("timeout of "+c+"ms occured while fetching resource: "+e)}function C(_){console.error(_),h("")}})}function m(e,c){return"data:"+c+";base64,"+e}function I(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function y(e){return function(c){return new Promise(function(h){setTimeout(function(){h(c)},e)})}}function d(e){for(var c=[],h=e.length,f=0;f<h;f++)c.push(e[f]);return c}function P(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")}function B(e){var c=A(e,"border-left-width"),h=A(e,"border-right-width");return e.scrollWidth+c+h}function b(e){var c=A(e,"border-top-width"),h=A(e,"border-bottom-width");return e.scrollHeight+c+h}function A(e,c){var h=window.getComputedStyle(e).getPropertyValue(c);return parseFloat(h.replace("px",""))}}function te(){var n=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:l,shouldProcess:t,impl:{readUrls:r,inline:i}};function t(s){return s.search(n)!==-1}function r(s){for(var o=[],u;(u=n.exec(s))!==null;)o.push(u[1]);return o.filter(function(p){return!a.isDataUrl(p)})}function i(s,o,u,p){return Promise.resolve(o).then(function(m){return u?a.resolveUrl(m,u):m}).then(p||a.getAndEncode).then(function(m){return a.dataAsUrl(m,a.mimeType(o))}).then(function(m){return s.replace(x(o),"$1"+m+"$3")});function x(m){return new RegExp(`(url\\(['"]?)(`+a.escape(m)+`)(['"]?\\))`,"g")}}function l(s,o,u){if(p())return Promise.resolve(s);return Promise.resolve(s).then(r).then(function(x){var m=Promise.resolve(s);return x.forEach(function(I){m=m.then(function(y){return i(y,I,o,u)})}),m});function p(){return!t(s)}}}function ne(){return{resolveAll:n,impl:{readAll:t}};function n(){return t().then(function(r){return Promise.all(r.map(function(i){return i.resolve()}))}).then(function(r){return r.join(`
`)})}function t(){return Promise.resolve(a.asArray(document.styleSheets)).then(i).then(r).then(function(s){return s.map(l)});function r(s){return s.filter(function(o){return o.type===CSSRule.FONT_FACE_RULE}).filter(function(o){return v.shouldProcess(o.style.getPropertyValue("src"))})}function i(s){var o=[];return s.forEach(function(u){try{a.asArray(u.cssRules||[]).forEach(o.push.bind(o))}catch(p){console.log("Error while reading CSS rules from "+u.href,p.toString())}}),o}function l(s){return{resolve:function(){var u=(s.parentStyleSheet||{}).href;return v.inlineAll(s.cssText,u)},src:function(){return s.style.getPropertyValue("src")}}}}}function re(){return{inlineAll:t,impl:{newImage:n}};function n(r){return{inline:i};function i(l){return a.isDataUrl(r.src)?Promise.resolve():Promise.resolve(r.src).then(l||a.getAndEncode).then(function(s){return a.dataAsUrl(s,a.mimeType(r.src))}).then(function(s){return new Promise(function(o,u){r.onload=o,r.onerror=u,r.src=s})})}}function t(r){if(!(r instanceof Element))return Promise.resolve(r);return i(r).then(function(){return r instanceof HTMLImageElement?n(r).inline():Promise.all(a.asArray(r.childNodes).map(function(l){return t(l)}))});function i(l){var s=l.style.getPropertyValue("background");return s?v.inlineAll(s).then(function(o){l.style.setProperty("background",o,l.style.getPropertyPriority("background"))}).then(function(){return l}):Promise.resolve(l)}}}})()})(se);const G=F,le=()=>({toJpeg:async(a,v={},S="domToImage")=>{G.toJpeg(a,v).then(function(k){const w=document.createElement("a");w.download=`${S}.jpeg`,w.href=k,w.click()})},toPng:async(a,v={},S="domToImage")=>{G.toPng(a,v).then(function(k){const w=document.createElement("a");w.download=`${S}.png`,w.href=k,w.click()})}});const fe={class:"dom-to-image-container"},he=$("a",{href:"https://github.com/tsayen/dom-to-image",target:"_blank"},"dom-to-image",-1),de={__name:"index",setup(U){const L=le(),a=oe({refDom:null}),{refDom:v}=ie(a),S=()=>{L.toJpeg(v.value)},k=()=>{L.toPng(v.value)};return(w,T)=>{const D=ce;return ae(),ue("div",fe,[$("aside",{ref_key:"refDom",ref:v},[he,M(" is a library which can turn arbitrary DOM node into a vector (SVG) or raster (PNG or JPEG) image, written in JavaScript. It's based on domvas by Paul Bakaus and has been completely rewritten, with some bugs fixed and some new features (like web font and image support) added. ")],512),H(D,{onClick:S,type:"primary"},{default:J(()=>[M("下载 jpeg")]),_:1}),H(D,{onClick:k,type:"primary"},{default:J(()=>[M("下载 Png")]),_:1})])}}};export{de as default};
